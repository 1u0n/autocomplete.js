/* Autocomplete.js v1.2.0 developed by Baptiste Donaux | Under MITÂ Licence | (c) 2014, Baptiste Donaux */
var AutoComplete=function(e){this.Ajax=function(e,t,n,r,i,s,o,u){if(e!==undefined){e.abort()}if(n==="GET"){t=t+"?"+i}e=new XMLHttpRequest;e.open(n,t,true);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.setRequestHeader("Content-length",i.length);e.setRequestHeader("Connection","close");e.onreadystatechange=function(){if(e.readyState===4&&e.status===200){if(r==="HTML"){o.innerHTML=e.response}else{var t=false,n,i=JSON.parse(e.response),a=document.createElement("ul");if(Object.prototype.toString.call(i)==="[object Array]"){if(i.length!==0){for(var f=0;f<i.length;f++){n=document.createElement("li");n.innerHTML=i[f];a.appendChild(n)}}else{t=true;n=document.createElement("li");n.setAttribute("class","locked");n.innerHTML=u;a.appendChild(n)}}else{for(var l in i){if(i.hasOwnProperty(l)){n=document.createElement("li");n.innerHTML=i[l];n.setAttribute("data-autocomplete-value",l);a.appendChild(n)}}}if(o.hasChildNodes()){o.childNodes[0].remove()}o.appendChild(a)}if(t===false){Result(s,o)}}};e.send(i);return e};this.BindCollection=function(e){var t=null,n=document.querySelectorAll(e);for(var r=n.length-1;r>=0;r--){t=n[r];if(t.nodeName.toUpperCase()==="INPUT"&&t.type.toUpperCase()==="TEXT"){BindOne(t)}}};this.BindOne=function(e){if(e!=null){var t=this.params,n=document.createElement("div"),r,i=e.offsetTop+e.offsetHeight,s;n.setAttribute("class","resultsAutocomplete");n.setAttribute("style","top:"+i+"px;left:"+e.offsetLeft+"px;width:"+e.clientWidth+"px;");e.parentNode.appendChild(n);e.setAttribute("autocomplete","off");e.addEventListener("focus",function(t){var r=e.getAttribute("data-autocomplete-old-value");if(r===null||e.value!==r){n.setAttribute("class","resultsAutocomplete open")}});e.addEventListener("blur",function(e){Close(n)});e.addEventListener("keyup",function(i){var s=i.currentTarget.value;if(s!==""){var o,u=i.currentTarget.getAttribute("data-autocomplete"),a=i.currentTarget.getAttribute("data-autocomplete-method"),f=i.currentTarget.getAttribute("data-autocomplete-param-name"),l=e.getAttribute("data-autocomplete-type"),c=e.getAttribute("data-autocomplete-no-result");a=a!==null?a.toUpperCase():null;l=l!==null?l.toUpperCase():null;if(l===null||l!=="JSON"&&l!=="HTML"){l=t.type}if(a===null||a!="GET"&&a!="POST"){a=t.method}if(f===null){f=t.paramName}if(c===null){c=t.noResult}o=f+"="+s;if(u!==null){var h=e.getAttribute("data-autocomplete-old-value");if(h===null||s!==h){n.setAttribute("class","resultsAutocomplete open")}r=Ajax(r,u,a,l,o,e,n,c)}}})}};this.Close=function(e,t){if(t===true){e.setAttribute("class","resultsAutocomplete")}else{setTimeout(function(){Close(e,true)},100)}};this.Initialize=function(){if(this.params===undefined){this.params={}}if(this.params.method===undefined||this.params.method.toUpperCase()!=="GET"&&this.params.method.toUpperCase()!=="POST"){this.params.method="GET"}else{this.params.method=this.params.method.toUpperCase()}if(this.params.paramName===undefined){this.params.paramName="q"}if(this.params.selector===undefined){this.params.selector=["input[data-autocomplete]"]}if(this.params.type===undefined||this.params.type.toUpperCase()!=="JSON"&&this.params.type.toUpperCase()!=="HTML"){this.params.type="JSON"}else{this.params.type=this.params.type.toUpperCase()}if(this.params.noResult===undefined){this.params.noResult="No result"}};this.Result=function(e,t){var n=t.getElementsByTagName("li");for(var r=n.length-1;r>=0;r--){n[r].addEventListener("click",function(t){var n=t.currentTarget;if(n.hasAttribute("data-autocomplete-value")){e.value=n.getAttribute("data-autocomplete-value")}else{e.value=n.innerHTML}e.setAttribute("data-autocomplete-old-value",e.value)})}};this.params=e;this.Initialize();for(var t=this.params.selector.length-1;t>=0;t--){this.BindCollection(this.params.selector[t])}}