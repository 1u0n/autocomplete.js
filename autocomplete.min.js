/* Autocomplete.js v1.0.0 developed by Baptiste Donaux | Under MITÂ Licence | (c) 2014, Baptiste Donaux */
function AutoComplete(e){var e=e;var t=function(){e=AutoComplete.initialize(e);for(var t=e.selector.length-1;t>=0;t--){AutoComplete.bindCollection(e.selector[t],e)}}()}AutoComplete.ajax=function(e,t,n,r,i,s,o,u){if(e!==undefined){e.abort()}if(n==="GET"){t=t+"?"+i}e=new XMLHttpRequest;e.open(n,t,true);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.setRequestHeader("Content-length",i.length);e.setRequestHeader("Connection","close");e.onreadystatechange=function(){if(e.readyState===4&&e.status===200){if(r==="HTML"){o.innerHTML=e.response}else{var t,n=JSON.parse(e.response),i=document.createElement("ul");if(Object.prototype.toString.call(n)==="[object Array]"){for(var u=0;u<n.length;u++){t=document.createElement("li");t.innerHTML=n[u];i.appendChild(t)}}else{for(var a in n){if(n.hasOwnProperty(a)){t=document.createElement("li");t.innerHTML=n[a];t.setAttribute("data-autocomplete-value",a);i.appendChild(t)}}}if(o.hasChildNodes()){o.childNodes[0].remove()}o.appendChild(i)}AutoComplete.result(s,o)}};e.send(i);return e};AutoComplete.bindCollection=function(e,t){var n=null,r=document.querySelectorAll(e);for(var i=r.length-1;i>=0;i--){n=r[i];if(n.nodeName.toUpperCase()==="INPUT"&&n.type.toUpperCase()==="TEXT"){AutoComplete.bindOne(n,t)}}};AutoComplete.bindOne=function(e,t){if(e!=null){var n=document.createElement("div"),r,i=e.offsetTop+e.offsetHeight,s;n.setAttribute("class","resultsAutocomplete");n.setAttribute("style","top:"+i+"px;left:"+e.offsetLeft+"px;width:"+e.clientWidth+"px;");e.parentNode.appendChild(n);e.setAttribute("autocomplete","off");e.addEventListener("focus",function(t){var r=e.getAttribute("data-autocomplete-old-value");if(r===null||e.value!==r){n.setAttribute("class","resultsAutocomplete open")}});e.addEventListener("blur",function(e){AutoComplete.close(n)});e.addEventListener("keyup",function(i){var s=i.currentTarget.value;if(s!==""){var o,u=i.currentTarget.getAttribute("data-autocomplete"),a=i.currentTarget.getAttribute("data-autocomplete-method"),f=i.currentTarget.getAttribute("data-autocomplete-param-name"),l=e.getAttribute("data-autocomplete-type");a=a!==null?a.toUpperCase():null;l=l!==null?l.toUpperCase():null;if(l===null||l!=="JSON"&&l!=="HTML"){l=t.type}if(a===null||a!="GET"&&a!="POST"){a=t.method}if(f===null){f=t.paramName}o=f+"="+s;if(u!==null){var c=e.getAttribute("data-autocomplete-old-value");if(c===null||s!==c){n.setAttribute("class","resultsAutocomplete open")}r=AutoComplete.ajax(r,u,a,l,o,e,n,t)}}})}};AutoComplete.close=function(e,t){if(t===true){e.setAttribute("class","resultsAutocomplete")}else{setTimeout(function(){AutoComplete.close(e,true)},100)}};AutoComplete.initialize=function(e){if(e===undefined){e={}}if(e.method===undefined||e.method.toUpperCase()!=="GET"&&e.method.toUpperCase()!=="POST"){e.method="GET"}else{e.method=e.method.toUpperCase()}if(e.paramName===undefined){e.paramName="q"}if(e.selector===undefined){e.selector=["input[data-autocomplete]"]}if(e.type===undefined||e.type.toUpperCase()!=="JSON"&&e.type.toUpperCase()!=="HTML"){e.type="JSON"}else{e.type=e.type.toUpperCase()}return e};AutoComplete.result=function(e,t){var n=t.getElementsByTagName("li");for(var r=n.length-1;r>=0;r--){n[r].addEventListener("click",function(t){var n=t.currentTarget;if(n.hasAttribute("data-autocomplete-value")){e.value=n.getAttribute("data-autocomplete-value")}else{e.value=n.innerHTML}e.setAttribute("data-autocomplete-old-value",e.value)})}}