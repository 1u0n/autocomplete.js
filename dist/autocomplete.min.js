function attr(a,b,c){if(null!==a){if("string"==typeof b)return a.hasAttribute(b)?a.getAttribute(b):c;for(var d in b)a.setAttribute(d,b[d])}}function attrClass(a,b){if(null!==a){if(void 0===b)return attr(a,"class");attr(a,{"class":b})}}function domCreate(a){return document.createElement(a)}var AutoComplete=function(){"use strict";function a(a,b,c,d,e){a&&a.abort();var f=b.method,g=b.url;return f.match(/^GET$/i)&&(g+="?"+c),a=new XMLHttpRequest,a.open(f,g,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&b.post(e,a.response,b)!==!0&&b.open(d,e)},a.send(c),a}function b(a,c){c?attrClass(a,"autocomplete"):setTimeout(function(){b(a,!0)},150)}function c(a,b){var c,d={};for(c in a)d[c]=a[c];for(c in b)d[c]=b[c];return d}var d=function(e){if(this){var f,g=this,h={limit:0,method:"GET",noResult:"No result",paramName:"q",select:function(a,b){attr(a,{"data-autocomplete-old-value":a.value=attr(b,"data-autocomplete-value",b.innerHTML)})},open:function(a,b){var c=this;Array.prototype.forEach.call(b.getElementsByTagName("li"),function(b){b.onclick=function(b){c.select(a,b.target)}})},post:function(a,b,c){try{b=JSON.parse(b);var d,e,f,g,h=function(){return domCreate("li")},i=function(a,b){return 0>b?a.reverse():a},j=function(a,b,c){return b.innerHTML=c,a.appendChild(b),h()},k=0,l=b.length,m=h(),n=domCreate("ul"),o=c.limit;if(Array.isArray(b))if(l)for(b=i(b,o);l>k&&(k<Math.abs(o)||!o);k++)m=j(n,m,b[k]);else d=!0,attrClass(m,"locked"),m=j(n,m,c.noResult);else{f=i(Object.getOwnPropertyNames(b),o);for(e in f)g=f[e],(parseInt(e)<Math.abs(o)||!o)&&(attr(m,{"data-autocomplete-value":g}),m=j(n,m,b[g]))}return a.hasChildNodes()&&a.childNodes[0].remove(),a.appendChild(n),d}catch(p){a.innerHTML=b}},pre:function(a){return a.value},selector:["input[data-autocomplete]"]};g._custArgs=[],g._args=c(h,e||{}),g._args.method.match(/^GET|POST$/i)||(g._args.method=h.method),f=g._args.selector,Array.isArray(f)||(f=[f]),f.forEach(function(c){Array.prototype.forEach.call(document.querySelectorAll(c),function(c){if(c.nodeName.match(/^INPUT$/i)&&c.type.match(/^TEXT|SEARCH$/i)){var d,e="data-autocomplete-old-value",f=domCreate("div"),h=function(){attr(f,{"class":"autocomplete",style:"top:"+(c.offsetTop+c.offsetHeight)+"px;left:"+c.offsetLeft+"px;width:"+c.clientWidth+"px;"})},i=function(){c.onfocus=c.onblur=c.onkeyup=null,c.removeEventListener("position",h),c.removeEventListener("destroy",i),f.parentNode.removeChild(f),g.CustParams(c,!0)},j=function(){var a=attr(c,e);a&&c.value==a||attrClass(f,"autocomplete open")};attr(c,{autocomplete:"off"}),h(c,f),c.addEventListener("position",h),c.addEventListener("destroy",i),c.parentNode.appendChild(f),c.onfocus=j,c.onblur=b.bind(null,f),c.onkeyup=function(b){var c,h=b.keyCode,i=b.target;if(13==h&&-1!=attrClass(f).indexOf("open")&&(c=f.querySelector("li.active"),null!==c&&(g._args.select(i,c),attrClass(f,"autocomplete"))),38==h||40==h)if(c=f.querySelector("li.active"),null===c){var j=f.querySelector("li:first-child:not(.locked)");null!==j&&attrClass(j,"active")}else{var k=Array.prototype.indexOf.call(c.parentNode.children,c),l=k+(h-39),m=f.getElementsByTagName("li").length;attrClass(c,""),0>l?l=m-1:l>=m&&(l=0),attrClass(c.parentElement.childNodes.item(l),"active")}else if(35>h||h>40){var n=g.CustParams(i),o=n.pre(i),p=attr(i,e);o&&n.url&&(p&&o==p||attrClass(f,"autocomplete open"),d=a(d,n,n.paramName+"="+o,i,f))}}}})})}else new d(e)};return d.prototype={CustParams:function(a,b){var d="data-autocomplete-id",e=this;if(b)return void delete e._custArgs[attr(a,d)];if(!a.hasAttribute(d)){a.setAttribute(d,e._custArgs.length);var f,g="data-autocomplete",h={limit:g+"-limit",method:g+"-method",noResult:g+"-no-result",paramName:g+"-param-name",url:g},i=Object.getOwnPropertyNames(h);for(f=i.length-1;f>=0;f--)h[i[f]]=attr(a,h[i[f]]);for(f in h)h.hasOwnProperty(f)&&!h[f]&&delete h[f];h.method&&!h.method.match(/^GET|POST$/i)&&delete h.method,h.limit&&(isNaN(h.limit)?delete h.limit:h.limit=parseInt(h.limit)),e._custArgs.push(c(this._args,h))}return e._custArgs[attr(a,d)]}},d}();
//# sourceMappingURL=autocomplete.min.js.map