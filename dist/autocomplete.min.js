var AutoComplete=function(){"use strict";function a(a,b){if(null!==a){if("string"==typeof b)return a.getAttribute(b);for(var c in b)a.setAttribute(c,b[c])}}function b(b,c){if(null!==b){if(void 0===typeof c)return a(b,"class");a(b,{"class":c})}}function c(a){return document.createElement(a)}function d(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c}var e=function(a){if(this){this._args=a,this._custArgs=[],this.Init();for(var b=this._args.selector.length-1;b>=0;b--)this.BindCollection(this,this._args.selector[b])}else new e(a)};return e.prototype={Ajax:function(a,b,c,d,e){a&&a.abort();var f=b.method,g=b.url;return f.match(/^GET$/i)&&(g+="?"+c),a=new XMLHttpRequest,a.open(f,g,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&b.post(e,a.response,b)!==!0&&b.open(d,e)},a.send(c),a},BindCollection:function(a,b){var c,d,e=document.querySelectorAll(b);for(c=e.length-1;c>=0;c--)d=e[c],d.nodeName.match(/^INPUT$/i)&&d.type.match(/^TEXT|SEARCH$/i)&&this.BindOne(a,d)},BindOne:function(d,e){if(e){var f,g="data-autocomplete-old-value",h=this,i=c("div"),j=e.addEventListener;a(e,{autocomplete:"off"}),h.Position(e,i),j("position",function(){h.Position(e,i)}),e.parentNode.appendChild(i),j("focus",function(){var c=a(e,g);c&&e.value==c||b(i,"autocomplete open")}),j("blur",function(){h.Close(i)}),j("keyup",function(c){var e,j=c.keyCode,k=c.target;if(13==j&&-1!=b(i).indexOf("open")&&(e=i.querySelector("li.active"),null!==e&&(d._args.select(k,e),b(i,"autocomplete"))),38==j||40==j)if(e=i.querySelector("li.active"),null===e){var l=i.querySelector("li:first-child:not(.locked)");null!==l&&b(l,"active")}else{var m=Array.prototype.indexOf.call(e.parentNode.children,e);b(e,"");var n=m+(j-39),o=i.getElementsByTagName("li").length;0>n?n=o-1:n>=o&&(n=0),b(e.parentElement.childNodes.item(n),"active")}else if(35>j||j>40){var p=h.CustParams(k),q=p.pre(k);if(q&&p.url){var r=a(k,g);r&&q==r||b(i,"autocomplete open"),f=h.Ajax(f,p,p.paramName+"="+q,k,i)}}})}},Close:function(a,c){var d=this;c?b(a,"autocomplete"):setTimeout(function(){d.Close(a,!0)},150)},CreateCustParams:function(b){for(var c={limit:"data-autocomplete-limit",method:"data-autocomplete-method",noResult:"data-autocomplete-no-result",paramName:"data-autocomplete-param-name",url:"data-autocomplete"},e=this,f=Object.getOwnPropertyNames(c),g=f.length-1;g>=0;g--)c[f[g]]=a(b,c[f[g]]);for(var h in c)c.hasOwnProperty(h)&&!c[h]&&delete c[h];return c.method&&!c.method.match(/^GET|POST$/i)&&delete c.method,c.limit&&(isNaN(c.limit)?delete c.limit:c.limit=parseInt(c.limit)),d(e._args,c)},CustParams:function(b){var c="data-autocomplete-id",d=this;return b.hasAttribute(c)||(b.setAttribute(c,d._custArgs.length),d._custArgs.push(d.CreateCustParams(b))),d._custArgs[a(b,c)]},Init:function(){var e=this,f={limit:0,method:"GET",noResult:"No result",paramName:"q",select:function(b,c){var d="data-autocomplete-value";b.value=c.hasAttribute(d)?a(c,d):c.innerHTML,a(b,{"data-autocomplete-old-value":b.value})},open:function(a,b){for(var c=function(b,c){c.addEventListener("click",function(c){b.select(a,c.target)})},d=b.getElementsByTagName("li"),e=d.length-1;e>=0;e--)c(this,d[e])},post:function(d,e,f){try{e=JSON.parse(e);var g,h=e.length,i=c("li"),j=c("ul");if(Array.isArray(e))if(h){f.limit<0&&e.reverse();for(var k=0;h>k&&(k<Math.abs(f.limit)||!f.limit);k++)i.innerHTML=e[k],j.appendChild(i),i=c("li")}else g=!0,b(i,"locked"),i.innerHTML=f.noResult,j.appendChild(i);else{var l=Object.getOwnPropertyNames(e);f.limit<0&&l.reverse();for(var m in l)(parseInt(m)<Math.abs(f.limit)||!f.limit)&&(i.innerHTML=e[l[m]],a(i,{"data-autocomplete-value":l[m]}),j.appendChild(i),i=c("li"))}return d.hasChildNodes()&&d.childNodes[0].remove(),d.appendChild(j),g}catch(n){d.innerHTML=e}},pre:function(a){return a.value},selector:["input[data-autocomplete]"]};void 0===e._args&&(e._args={}),e._args=d(f,e._args),e._args.method.match(/^GET|POST$/i)||(e._args.method=f.method),Array.isArray(e._args.selector)||(e._args.selector=f.selector)},Position:function(b,c){a(c,{"class":"autocomplete",style:"top:"+(b.offsetTop+b.offsetHeight)+"px;left:"+b.offsetLeft+"px;width:"+b.clientWidth+"px;"})}},e}();
//# sourceMappingURL=autocomplete.min.js.map