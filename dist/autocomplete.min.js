!function(){"use strict";function a(a,b){if(null!==a){if("string"==typeof b)return a.getAttribute(b);for(var c in b)a.setAttribute(c,b[c])}}function b(a){return document.createElement(a)}function c(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c}var d=function(a){if(this){this._args=a,this._custArgs=[],this.Init();for(var b=this._args.selector.length-1;b>=0;b--)this.BindCollection(this,this._args.selector[b])}else new d(a)};d.prototype={Ajax:function(a,b,c,d,e){a&&a.abort();var f=b.method,g=b.url;return f.match(/^GET$/i)&&(g+="?"+c),a=new XMLHttpRequest,a.open(f,g,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&b.post(e,a.response,b)!==!0&&b.open(d,e)},a.send(c),a},BindCollection:function(a,b){for(var c,d=document.querySelectorAll(b),e=d.length-1;e>=0;e--)c=d[e],c.nodeName.match(/^INPUT$/i)&&(c.type.match(/^TEXT$/i)||c.type.match(/^SEARCH$/i))&&this.BindOne(a,c)},BindOne:function(c,d){if(d){var e,f="data-autocomplete-old-value",g=this,h=b("div");a(d,{autocomplete:"off"}),g.Position(d,h),d.addEventListener("autocomplete:position",function(){g.Position(d,h)}),d.parentNode.appendChild(h),d.addEventListener("focus",function(){var b=a(d,f);b&&d.value==b||a(h,{"class":"autocomplete open"})}),d.addEventListener("blur",function(){g.Close(h)}),d.addEventListener("keyup",function(b){var d,i=b.keyCode;if(13==i&&-1!=h.getAttribute("class").indexOf("open")&&(d=h.querySelector("li.active"),null!==d&&(c._args.select(b.currentTarget,d),a(h,{"class":"autocomplete"}))),38==i||40==i)if(d=h.querySelector("li.active"),null===d){var j=h.querySelector("li:first-child:not(.locked)");null!==j&&a(j,{"class":"active"})}else{var k=Array.prototype.indexOf.call(d.parentNode.children,d);a(d,{"class":""});var l=k+(i-39),m=h.getElementsByTagName("li").length;0>l?l=m-1:l>=m&&(l=0),a(d.parentElement.childNodes.item(l),{"class":"active"})}else if(35>i||i>40){var n=b.currentTarget,o=g.CustParams(n),p=o.pre(n);if(p&&o.url){var q=a(n,f);q&&p==q||a(h,{"class":"autocomplete open"}),e=g.Ajax(e,o,o.paramName+"="+p,n,h)}}})}},Close:function(b,c){var d=this;c?a(b,{"class":"autocomplete"}):setTimeout(function(){d.Close(b,!0)},150)},CreateCustParams:function(b){for(var d={limit:"data-autocomplete-limit",method:"data-autocomplete-method",noResult:"data-autocomplete-no-result",paramName:"data-autocomplete-param-name",url:"data-autocomplete"},e=this,f=Object.getOwnPropertyNames(d),g=f.length-1;g>=0;g--)d[f[g]]=a(b,d[f[g]]);for(var h in d)d.hasOwnProperty(h)&&!d[h]&&delete d[h];return d.method&&!d.method.match(/^GET|POST$/i)&&delete d.method,d.limit&&(isNaN(d.limit)?delete d.limit:d.limit=parseInt(d.limit)),c(e._args,d)},CustParams:function(b){var c="data-autocomplete-id",d=this;return b.hasAttribute(c)||(b.setAttribute(c,d._custArgs.length),d._custArgs.push(d.CreateCustParams(b))),d._custArgs[a(b,c)]},Init:function(){var d=this,e={limit:0,method:"GET",noResult:"No result",paramName:"q",select:function(b,c){var d="data-autocomplete-value";b.value=c.hasAttribute(d)?a(c,d):c.innerHTML,a(b,{"data-autocomplete-old-value":b.value})},open:function(a,b){for(var c=function(b,c){c.addEventListener("click",function(c){b.select(a,c.currentTarget)})},d=b.getElementsByTagName("li"),e=d.length-1;e>=0;e--)c(this,d[e])},post:function(c,d,e){try{d=JSON.parse(d);var f,g=d.length,h=b("li"),i=b("ul");if(Array.isArray(d))if(g){e.limit<0&&d.reverse();for(var j=0;g>j&&(j<Math.abs(e.limit)||!e.limit);j++)h.innerHTML=d[j],i.appendChild(h),h=b("li")}else f=!0,a(h,{"class":"locked"}),h.innerHTML=e.noResult,i.appendChild(h);else{var k=Object.getOwnPropertyNames(d);e.limit<0&&k.reverse();for(var l in k)(parseInt(l)<Math.abs(e.limit)||!e.limit)&&(h.innerHTML=d[k[l]],a(h,{"data-autocomplete-value":k[l]}),i.appendChild(h),h=b("li"))}return c.hasChildNodes()&&c.childNodes[0].remove(),c.appendChild(i),f}catch(m){c.innerHTML=d}},pre:function(a){return a.value},selector:["input[data-autocomplete]"]};void 0===d._args&&(d._args={}),d._args=c(e,d._args),d._args.method.match(/^GET|POST$/i)||(d._args.method=e.method),Array.isArray(d._args.selector)||(d._args.selector=e.selector)},Position:function(b,c){a(c,{"class":"autocomplete",style:"top:"+(b.offsetTop+b.offsetHeight)+"px;left:"+b.offsetLeft+"px;width:"+b.clientWidth+"px;"})}}}();
//# sourceMappingURL=autocomplete.min.js.map